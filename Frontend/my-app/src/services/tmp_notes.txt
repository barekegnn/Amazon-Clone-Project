export const fetchProviderProductById = async ({ id }) => {
  if (!id) {
    throw new Error("fetchProviderProductById: id is required");
  }

  const stringId = String(id);

  if (stringId.startsWith("book-")) {
    const bookId = stringId.replace("book-", "");
    const product = await booksHttpClient.get(
      `/products/${encodeURIComponent(bookId)}`
    );

    return {
      id: `book-${product.id}`,
      title: product.title,
      price: product.price,
      description: product.description,
      image: product.thumbnail || product.images?.[0],
      rating: {
        rate: product.rating,
        count: product.stock,
      },
      category: "books",
      _provider: "dummyjson",
    };
  }
  
  // Bug fix: The Home.jsx might be passing '1-books' or similar if I made a mistake,
  // aka line 92: `id: '1-books'`. 
  // This causes fakestoreapi to 404 because it wants an integer ID for GET /products/:id.
  // I should check if the ID is purely numeric or handle it.
  
  // However, I see `id: '9'`, `id: '13'` which are numeric strings.
  // The error "Product Not Found" on `/product/9` suggests that fakestoreapi returned null or error for ID 9.
  // Wait, fakestoreapi products are 1 to 20. 9 should exist.
  // Let's debug by logging.

  // Also, maybe the API response structure is unexpected?
  // CatalogApi expects `catalogHttpClient.get` to return the product object directly.
  // Fakestore returns properties: id, title, price, description, category, image, rating.
  // My interface expects these too.

  return catalogHttpClient.get(`/products/${encodeURIComponent(id)}`);
};
